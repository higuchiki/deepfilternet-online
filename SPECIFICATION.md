# ClearVoice AI 開発・運用仕様書

## 1. 概要
DeepFilterNet V3 を使用した、ブラウザ上で動作する高品質音声ノイズ除去サービス。

## 2. インフラ構成
- **プラットフォーム**: Google Cloud Run
- **リージョン**: asia-northeast1 (東京)
- **スペック**: 2 vCPU / 2GiB RAM
- **デプロイ方式**: GitHub `main` ブランチへのプッシュによる自動ビルド・デプロイ (CI/CD)
- **ビルド構成**: Cloud Build は `cloudbuild.yaml` を使用し、Kaniko を利用して高速ビルドを行います。

## 3. 開発・デプロイ・運用ルール (重要)

### 3.1 デプロイフロー
AIエージェントがコードの修正およびデプロイを行う際は、以下の手順を厳守すること。

1.  **コード修正**: 要望に基づき `web_enhance.py` や `Dockerfile` 等を修正。
2.  **GitHubプッシュ**: 修正内容を GitHub リポジトリへプッシュ。
3.  **ビルド監視**: Google Cloud Build のステータスを監視し、ビルドが完了するまで待機する。
4.  **反映確認**: 公開URL（Cloud Run サービスURL）にアクセスし、修正内容が正しく反映されていることを実機確認する。
5.  **完了報告**: **必ず Google Cloud への反映が完了したことを確認してから、ユーザーへ作業完了の報告を行うこと。** プッシュしただけの段階で報告してはならない。

### 3.2 依存関係の管理
- **Python環境**: Python 3.11 を使用（ライブラリの互換性維持のため）。
- **システムパッケージ**: `ffmpeg`, `git`, `libsox-dev` を `Dockerfile` でインストール必須。
- **Pythonライブラリ**: `requirements_cloud.txt` で管理。PyTorch は CPU 専用版を使用すること。

## 4. UI/UX デザイン指針
- **テーマ**: Next.js Docs (Vercel) 風のダークモード・ミニマルデザイン。
- **フォント**: Geist / Noto Sans JP (太さ 600 を標準とする)。
- **配置**: コンテンツは左寄せ。
- **比較機能**: オリジナルとAI処理後の音声を、再生中にシーク位置を維持したままミュート切り替えでシームレスに比較できること。

## 5. 連絡先・フィードバック
- **X (Twitter)**: [@HiguchiKi](https://x.com/HiguchiKi)
- ユーザーからのエラー報告やレビューは上記アカウントで受け付ける。
